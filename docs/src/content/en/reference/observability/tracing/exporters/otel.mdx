---
title: "Reference: OtelExporter | Observability"
description: OpenTelemetry exporter for Tracing
packages:
  - "@mastra/otel-exporter"
---

import PropertiesTable from "@site/src/components/PropertiesTable";

# OtelExporter

Sends Tracing data to any OpenTelemetry-compatible observability platform using standardized GenAI semantic conventions.

## Constructor

```typescript prettier:false
new OtelExporter(config: OtelExporterConfig)
```

## OtelExporterConfig

```typescript
interface OtelExporterConfig {
  provider?: ProviderConfig
  timeout?: number
  batchSize?: number
  logLevel?: 'debug' | 'info' | 'warn' | 'error'
}
```

<PropertiesTable
  props={[
{
name: "provider",
type: "ProviderConfig",
description: "Provider-specific configuration (see below)",
required: true,
},
{
name: "timeout",
type: "number",
description: "Export timeout in milliseconds (default: 30000)",
required: false,
},
{
name: "batchSize",
type: "number",
description: "Number of spans per batch (default: 100)",
required: false,
},
{
name: "logLevel",
type: "'debug' | 'info' | 'warn' | 'error'",
description: "Logger level (default: 'warn')",
required: false,
},
{
name: "resourceAttributes",
type: "DetectedResourceAttributes",
description:
"Optional OpenTelemetry Resource Attributes (values here override any defaults)",
required: false,
},
]}
/>

## Provider Configurations

### Dash0Config

```typescript
interface Dash0Config {
  apiKey?: string
  endpoint?: string
  dataset?: string
}
```

<PropertiesTable
  props={[
{
name: "apiKey",
type: "string",
description: "Dash0 API key. Falls back to DASH0_API_KEY env var.",
required: false,
},
{
name: "endpoint",
type: "string",
description:
"Dash0 ingress endpoint. Falls back to DASH0_ENDPOINT env var.",
required: false,
},
{
name: "dataset",
type: "string",
description: "Dataset name. Falls back to DASH0_DATASET env var.",
required: false,
},
]}
/>

### SignozConfig

```typescript
interface SignozConfig {
  apiKey?: string
  region?: 'us' | 'eu' | 'in'
  endpoint?: string
}
```

<PropertiesTable
  props={[
{
name: "apiKey",
type: "string",
description: "SigNoz ingestion key. Falls back to SIGNOZ_API_KEY env var.",
required: false,
},
{
name: "region",
type: "'us' | 'eu' | 'in'",
description: "SigNoz cloud region. Falls back to SIGNOZ_REGION env var. (default: 'us')",
required: false,
},
{
name: "endpoint",
type: "string",
description: "Custom endpoint. Falls back to SIGNOZ_ENDPOINT env var.",
required: false,
},
]}
/>

### NewRelicConfig

```typescript
interface NewRelicConfig {
  apiKey?: string
  endpoint?: string
}
```

<PropertiesTable
  props={[
{
name: "apiKey",
type: "string",
description: "New Relic license key. Falls back to NEW_RELIC_LICENSE_KEY env var.",
required: false,
},
{
name: "endpoint",
type: "string",
description:
"Custom endpoint. Falls back to NEW_RELIC_ENDPOINT env var. (default: https://otlp.nr-data.net:443/v1/traces)",
required: false,
},
]}
/>

### TraceloopConfig

```typescript
interface TraceloopConfig {
  apiKey?: string
  destinationId?: string
  endpoint?: string
}
```

<PropertiesTable
  props={[
{
name: "apiKey",
type: "string",
description: "Traceloop API key. Falls back to TRACELOOP_API_KEY env var.",
required: false,
},
{
name: "destinationId",
type: "string",
description: "Destination identifier. Falls back to TRACELOOP_DESTINATION_ID env var.",
required: false,
},
{
name: "endpoint",
type: "string",
description:
"Custom endpoint. Falls back to TRACELOOP_ENDPOINT env var. (default: https://api.traceloop.com/v1/traces)",
required: false,
},
]}
/>

### LaminarConfig

```typescript
interface LaminarConfig {
  apiKey?: string
  endpoint?: string
}
```

<PropertiesTable
  props={[
{
name: "apiKey",
type: "string",
description: "Laminar project API key. Falls back to LMNR_PROJECT_API_KEY env var.",
required: false,
},
{
name: "endpoint",
type: "string",
description: "Custom endpoint. Falls back to LAMINAR_ENDPOINT env var. (default: https://api.lmnr.ai/v1/traces)",
required: false,
},
]}
/>

### CustomConfig

```typescript
interface CustomConfig {
  endpoint: string
  protocol?: 'http/json' | 'http/protobuf' | 'grpc' | 'zipkin'
  headers?: Record<string, string>
}
```

<PropertiesTable
  props={[
{
name: "endpoint",
type: "string",
description: "OTEL collector endpoint URL",
required: true,
},
{
name: "protocol",
type: "'http/json' | 'http/protobuf' | 'grpc' | 'zipkin'",
description: "Export protocol (default: 'http/json')",
required: false,
},
{
name: "headers",
type: "Record<string, string>",
description: "Custom headers for authentication",
required: false,
},
]}
/>

## Methods

### exportTracingEvent

```typescript prettier:false
async exportTracingEvent(event: TracingEvent): Promise<void>
```

Exports a tracing event to the configured OTEL backend.

### flush

```typescript prettier:false
async flush(): Promise<void>
```

Force flushes any buffered spans to the OTEL backend without shutting down the exporter. Useful in serverless environments where you need to ensure spans are exported before the runtime terminates.

### shutdown

```typescript prettier:false
async shutdown(): Promise<void>
```

Flushes pending traces and shuts down the exporter.

## Usage Examples

### Zero-Config (using environment variables)

```typescript
import { OtelExporter } from '@mastra/otel-exporter'

// Set SIGNOZ_API_KEY, SIGNOZ_REGION environment variables
const exporter = new OtelExporter({ provider: { signoz: {} } })

// Or for other providers:
// Set DASH0_API_KEY, DASH0_ENDPOINT for Dash0
// Set NEW_RELIC_LICENSE_KEY for New Relic
// Set TRACELOOP_API_KEY for Traceloop
// Set LMNR_PROJECT_API_KEY for Laminar
```

### Explicit Configuration

```typescript
import { OtelExporter } from '@mastra/otel-exporter'

const exporter = new OtelExporter({
  provider: {
    signoz: {
      apiKey: process.env.SIGNOZ_API_KEY,
      region: 'us',
    },
  },
})
```

### With Custom Endpoint

```typescript
const exporter = new OtelExporter({
  provider: {
    custom: {
      endpoint: 'https://my-collector.example.com/v1/traces',
      protocol: 'http/protobuf',
      headers: {
        'x-api-key': process.env.API_KEY,
      },
    },
  },
  timeout: 60000,
  logLevel: 'debug',
})
```

## Protocol Requirements

Different providers require different OTEL exporter packages:

| Protocol | Required Package | Providers |
| - | - | - |
| gRPC | `@opentelemetry/exporter-trace-otlp-grpc` | Dash0 |
| HTTP/Protobuf | `@opentelemetry/exporter-trace-otlp-proto` | SigNoz, New Relic, Laminar |
| HTTP/JSON | `@opentelemetry/exporter-trace-otlp-http` | Traceloop, Custom |
| Zipkin | `@opentelemetry/exporter-zipkin` | Zipkin collectors |

## Tags Support

The OtelExporter supports trace tagging for categorization and filtering. Tags are only applied to root spans and are stored as the `mastra.tags` attribute.

### Usage

```typescript
const result = await agent.generate('Hello', {
  tracingOptions: {
    tags: ['production', 'experiment-v2', 'user-request'],
  },
})
```

### How Tags Are Stored

Tags are stored as a JSON-stringified array in the `mastra.tags` span attribute for maximum backend compatibility:

```json
{
  "mastra.tags": "[\"production\",\"experiment-v2\",\"user-request\"]"
}
```

:::note
While the OpenTelemetry specification supports native array attributes, many backends (Jaeger, Zipkin, Tempo) have limited array support. JSON strings ensure consistent behavior across all observability platforms.
:::

## Related

- [OtelExporter Guide](/docs/observability/tracing/exporters/otel) - Setup guide with provider configurations
- [OtelBridge](/docs/observability/tracing/bridges/otel) - For bidirectional OTEL context integration
- [Tracing Overview](/docs/observability/tracing/overview) - General tracing concepts
